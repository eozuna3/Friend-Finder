<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="Eduardo Ozuna">
<meta name="description" content="Friend Finder">
<title>Friend Finder</title>
<script src="https://code.jquery.com/jquery-3.5.0.min.js"
  integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
  integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
  integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
  integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
</head>

<body>
  <div class="container">
    <h2 class="border-bottom border-secondary py-2">Survey Questions</h2>
    <br>

    <!----------------------------  Survey Form ------------------------------------->
    <h3 class="font-weight-bold">About You</h3>
    <form>
      <div class="form-group">
        <label for="name">Name (Required)</label>
        <input type="text" class="form-control" id="name" aria-required>
      </div>
      <div class="form-group">
        <lable for="photoImage">Link to Photo Image (Required)</label>
          <input type="text" class="form-control" id="photoImage" aria-required>
      </div>
      <br>

      <div class="form-group">
        <h3 class="font-weight-bold">Question 1</h3>
        <p for="question1">You love a good party.</p>
        <select class="chosen-select" id="question1">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 2</h3>
        <p for="question2">You enjoy going to museums and cultural events.</p>
        <select class="chosen-select" id="question2">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 3</h3>
        <p for="question3">You like to talk about feelings and emotions.</p>
        <select class="chosen-select" id="question3">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 4</h3>
        <p for="question4">You like to keep a schedule.</p>
        <select class="chosen-select" id="question4">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 5</h3>
        <p for="question5">You like to talk about intellectual things like art and philosophy.</p>
        <select class="chosen-select" id="question5">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 6</h3>
        <p for="question6">You are a social butterfly.</p>
        <select class="chosen-select" id="question6">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 7</h3>
        <p for="question7">You love to travel to exotic places.</p>
        <select class="chosen-select" id="question7">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 8</h3>
        <p for="question8">You are more logical than emotional.</p>
        <select class="chosen-select" id="question8">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 9</h3>
        <p for="question9">You are very curious about the world.</p>
        <select class="chosen-select" id="question9">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <div class="form-group">
        <h3 class="font-weight-bold">Question 10</h3>
        <p for="question10">You are loyal to traditions.</p>
        <select class="chosen-select" id="question10">
          <option value></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
        </select>
      </div>
      <br>

      <button type="submit" class="btn btn-primary btn-lg btn-block" id="submitBtn">
        <i class="fa fa-check-circle" aria-hidden="true"></i> Submit
      </button>
    </form>
  </div>
  <br>

  <!--------------------------  Footer ----------------------------->
  <footer class="footer">
    <div class="container">
      <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/eozuna3/Friend-Finder"
          target="_blank">Github Repo</a></p>
    </div>
  </footer>

  <!---------------------------- Modal Alert Box --------------------------->
  <div class="modal fade" tabindex="-1" role="dialog" id="modalAlert">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title font-weight-bold"></h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <!-- Data goes here -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!----------  Javascript for get information from form and sending it friends.js -->
  <script type="text/javascript">
    $("#submitBtn").on("click", function (event) {
      event.preventDefault();
      var selectionArray = [];


      //  Code to make sure that the user has inputed all necessary information (Validation Code)
      var hasInput1 = false;
      var hasInput2 = 0;
      $('.form-control').each(function () {
        if ($(this).val() !== "") {
          hasInput1 = true;
        };
      });

      $('.chosen-select').each(function () {
        if ($(this).val() !== "") {
          hasInput2++;
        };
      });
      
      if (!hasInput1) {
        $(".modal-title").text("Missing Information");
        $(".modal-body").html("<p>Please make sure you enter all the information into the required text boxes.</p>");
        $('#modalAlert').modal('show');
        $('#modalAlert').modal('handleUpdate');
      } else if (hasInput2 < 10) {
        $(".modal-title").text("Missing Information");
        $(".modal-body").html("<p>Please fill out all the survey questions before submitting!</p>");
        $('#modalAlert').modal('show');
        $('#modalAlert').modal('handleUpdate');
      } else {
        // Create score array of integers for newUser from the information placed in the form
        $('.chosen-select').each(function () {
        selectionArray.push(parseInt($(this).val()));
      });
      console.log(selectionArray);
      
      //  Create the newUser object using information placed in the form above
      var newUser = {
        name: $("#name").val().trim(),
        photo: $("#photoImage").val().trim(),
        scores: selectionArray
      };
      console.log(newUser);

      //  POST method to send the newUser object to the server and returns the friend object that is the best match for the newUser in the response  
      $.post("/api/new", newUser, function (response) {
        $("#name").val("");
        $("#photoImage").val("");
        $('.chosen-select').each(function () {
          $(this).val("");
        });
        console.log(response);

        //  Outputs to the modal the best match information for the return friend object
        $(".modal-title").text("Best Match");
        $(".modal-body").html("<h2>"+ response.name + "</h2><img class='img-fluid' src='" + response.photo + "'>");
        $('#modalAlert').modal('show');
        $('#modalAlert').modal('handleUpdate');
      });
    }
});
  </script>
</body>

</html>